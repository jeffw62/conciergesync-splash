<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>ConciergeSync™ — Intake Section 1</title>
  <style>
    :root{
      --page-bg:#0b0f14;
      --ink:#eaf2ff; --muted:#9fb0c8;
      --glass-bg:rgba(255,255,255,.10);
      --glass-brd:rgba(255,255,255,.22);
      --glass-blur:blur(14px) saturate(1.1);
      --ring:0 0 0 3px rgba(255,255,255,.18);
    }
    html,body{height:100%}
    body{
      margin:0; color:var(--ink);
      font-family:system-ui,-apple-system,Segoe UI,Inter,Arial,sans-serif;
      background:var(--page-bg);
      display:flex; align-items:center; justify-content:center;
      min-height:100vh; padding:24px; position:relative; overflow:auto;
    }

    /* BIG gold logo background (same as 03) */
    .cs-bg{
      position:fixed; inset:0; z-index:-2;
      background:url('/beta/assets/CS_Logo_Premium.png') center/500px repeat;
      opacity:.75; pointer-events:none;
    }

    /* Vignette layer */
    body::after{
      content:""; position:fixed; inset:0; z-index:-1; pointer-events:none;
      background:
        radial-gradient(120% 120% at 50% 0%, rgba(255,255,255,.04), rgba(0,0,0,.28) 60%, rgba(0,0,0,.55) 100%),
        linear-gradient(180deg, rgba(255,255,255,.02), rgba(0,0,0,.08));
    }

    /* Glass tile container for NoteForms */
    .card{
      width:min(500px, 95vw);
      border-radius:22px;
      background:var(--glass-bg);
      backdrop-filter:var(--glass-blur);
      box-shadow:0 18px 48px rgba(0,0,0,.45), inset 0 0 0 1px var(--glass-brd);
      padding:24px; text-align:left;
    }

    header{display:flex; align-items:center; justify-content:space-between; gap:16px; margin-bottom:10px}
    h1{font-size:clamp(18px, 2.6vw, 24px); margin:0}
    .hint{color:var(--muted); font-size:13px}

    /* NoteForms embed */
    iframe{
      width:100%;
      min-height:78vh;              /* roomy on desktop */
      border:0; border-radius:14px;
      background:rgba(0,0,0,.35);  /* in case their theme is light */
    }
    @media (max-width:480px){
      .card{padding:18px}
      iframe{min-height:82vh}
    }
  </style>
</head>
<body>
  <div class="cs-bg"></div>

  <main class="card" role="main" aria-labelledby="hdr">
    <header>
      <h1 id="hdr">Section 1 — Getting started</h1>
      <div class="hint">Takes ~2 minutes</div>
    </header>

    <!-- Replace with your real NoteForms URL -->
  <!-- IFRAME -->
<iframe
  id="nf-embed"
  data-src="https://noteforms.com/forms/beta-user-tracker-conciergesync-b4yxaf?embed=true&theme=dark"
  style="width:100%;height:90vh;border:0;"
></iframe>

<!-- IFRAME -->
<script>
(function () {
  const qs = new URLSearchParams(location.search);
  const email = qs.get('email') || '';
  const first = qs.get('first') || '';
  const last  = qs.get('last')  || '';
  const uid   = qs.get('uid')   || '';
  const ret   = qs.get('return') || '/beta/03-intake-start.html';

  // Guard: must have email + uid to continue
  if (!email || !uid) {
    const back = encodeURIComponent(location.pathname + location.search);
    location.replace(`auth.html?mode=login&return=${back}`);
    return;
  }

  // Persist for all downstream pages
  localStorage.setItem('cs_email', email);
  localStorage.setItem('cs_first', first);
  localStorage.setItem('cs_last',  last);
  localStorage.setItem('cs_uid',   uid);
  localStorage.setItem('cs_return', ret);

  // Build the exact QS we want to carry forward
  const carry = new URLSearchParams({ email, first, last, uid, return: ret });

  // 1) Wire the primary Begin link/button
  const begin = document.querySelector('#begin-intake, a[href$="05-section-1.html"]');
  if (begin) {
    const u = new URL('05-section-1.html', location.href);
    carry.forEach((v,k) => u.searchParams.set(k, v));
    begin.setAttribute('href', u.pathname + '?' + u.searchParams.toString());
  }

  // 2) Any link marked .keepqs also gets the QS
  document.querySelectorAll('a.keepqs').forEach(a => {
    const u = new URL(a.getAttribute('href'), location.href);
    carry.forEach((v,k) => u.searchParams.set(k, v));
    a.setAttribute('href', u.pathname + '?' + u.searchParams.toString());
  });
})();
</script>

</body>
</html>
