<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ConciergeSync™ • Console</title>

  <style>
    :root{
      --ink:#0f172a;
      --muted:#64748b;
      --card:#fff;
      --bg:#f6f7fb;

      /* backdrop tuning */
      --overlay: .30;
      --overlay-top: rgba(0,0,0,.35);
      --overlay-bot: rgba(0,0,0,.55);

      /* motion */
      --cs-time: 560ms;
      --cs-ease: cubic-bezier(.22,1,.36,1);
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Inter, Arial, sans-serif;
      color:var(--ink);
      background:var(--bg);
      line-height:1.6;
    }

    /* ---------- Landing (only visible when NOT in console mode) ---------- */
    body.console-mode .landing{display:none}
    .landing{
      max-width:880px; margin:40px auto; padding:0 20px;
    }
    .card{
      background:var(--card);
      border:1px solid #e6eaf0;
      border-radius:16px;
      box-shadow:0 6px 24px rgba(15,23,42,.06);
      padding:28px;
      margin-bottom:24px;
    }
    .card h1{font-size:34px; line-height:1.2; text-align:center; margin:0 0 8px}
    .center{ text-align:center; }
    .muted{ color:var(--muted); }

    /* ---------- Console backdrop ---------- */
    .backdrop{
      position:fixed; inset:0; z-index:0; overflow:hidden;
    }
    .backdrop-image{
      position:absolute; inset:0;
      background:center/cover no-repeat;
      filter:brightness(1.1) contrast(1.05);
      transform:scale(1.02);
      opacity:0; transition:opacity 600ms ease, transform 900ms ease;
    }
    .backdrop-overlay{
      position:absolute; inset:0; pointer-events:none;
      background:linear-gradient(to bottom,var(--overlay-top),var(--overlay-bot));
      opacity:var(--overlay);
    }
    body.console-mode .backdrop-image{ opacity:1; transform:scale(1) }

    /* ---------- Console UI ---------- */
    #cs-console{
      position:absolute; inset:0; z-index:10;
      display:none;               /* hidden until console-mode */
      grid-template-rows:auto 1fr;
      padding:24px;
    }
    body.console-mode #cs-console{ display:grid }

    .cs-tabs{
      display:flex; justify-content:center; gap:10px;
      width:max-content; margin:0 auto 14px;
      padding:10px 12px;
      backdrop-filter:blur(8px) saturate(1.1);
      background:rgba(20,20,20,.30);
      border:1px solid rgba(255,255,255,.25);
      border-radius:14px;
    }
    .cs-tab{
      padding:10px 14px; border-radius:10px; cursor:pointer;
      color:#fff; background:rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.18);
      font-weight:600;
    }
    .cs-tab:hover{ background:rgba(255,255,255,.12) }

    .cs-tiles{
      position:relative;
      display:grid; grid-auto-flow:row dense;
      grid-template-columns: repeat(auto-fit, minmax(320px, 420px));
      gap:18px; align-content:start; justify-content:start;
      height:100%; padding:6px; overflow:visible;
    }
    .cs-tiles.single{ grid-template-columns:minmax(360px,520px); justify-content:center }

    .cs-tile{
      background:rgba(255,255,255,.12);
      border:1px solid rgba(255,255,255,.28);
      border-radius:18px; color:#eef2f7;
      box-shadow:0 10px 30px rgba(0,0,0,.18);
      backdrop-filter:blur(12px) saturate(1.2);
      display:grid; grid-template-rows:auto 1fr;
      min-height:260px; max-height:65vh; overflow:hidden;
      transform:none; opacity:1; transition:none;
      touch-action:pan-y; -webkit-tap-highlight-color:transparent;
      cursor:grab;
    }
    .cs-tile-head{
      display:flex; align-items:center; justify-content:space-between;
      padding:12px 14px; background:rgba(0,0,0,.18);
      border-bottom:1px solid rgba(255,255,255,.18);
    }
    .cs-tile-head h4{margin:0; font-size:15px; font-weight:700; letter-spacing:.2px}
    .cs-close{
      width:30px; height:30px; border-radius:8px;
      background:rgba(255,255,255,.12);
      color:#fff; border:1px solid rgba(255,255,255,.25);
      cursor:pointer; font-size:18px; line-height:28px; text-align:center;
    }
    .cs-tile-body{ padding:14px; overflow:auto }

    /* Exit (X) button — visible only in console mode */
    #exitConsole{
      position:fixed; top:18px; right:18px; z-index:20;
      width:40px; height:40px; border-radius:10px;
      border:1px solid rgba(255,255,255,.35);
      background:rgba(20,20,20,.45); color:#fff;
      font-size:28px; line-height:36px; text-align:center;
      cursor:pointer; backdrop-filter:blur(8px) saturate(1.1);
      display:none;
    }
    body.console-mode #exitConsole{ display:block }
  </style>
</head>

<body>

  <!-- Landing copy (only if NOT in console-mode) -->
  <main class="landing">
    <section class="card">
      <h1>Welcome to ConciergeSync™</h1>
      <p class="center muted">Your personal travel rewards strategist — earn, manage, and redeem points with clarity.</p>
    </section>

    <section class="card">
      <h2 class="center">Place Holder</h2>
      <p class="muted">Short welcome blurb lives here.</p>
    </section>
  </main>

  <!-- Backdrop for console -->
  <div class="backdrop" aria-hidden="true">
    <div class="backdrop-image" id="backdropImage"></div>
    <div class="backdrop-overlay"></div>
  </div>

  <!-- Console UI -->
  <div id="cs-console" role="region" aria-label="ConciergeSync Console">
    <div class="cs-tabs" aria-label="Console Tabs">
      <button class="cs-tab" data-key="overview">Overview</button>
      <button class="cs-tab" data-key="itinerary">Itinerary</button>
      <button class="cs-tab" data-key="values">Value Calc</button>
    </div>

    <div id="cs-tiles" class="cs-tiles" aria-live="polite"></div>
  </div>

  <!-- Exit (X) -->
  <button id="exitConsole" aria-label="Exit Console" type="button" onclick="window.location.href='exit.html'">×</button>

  <script>
  (function(){
    /* ---------- 1) Console auto-enter when ?enter=1 ---------- */
    const qp = new URLSearchParams(location.search);
    const autoEnter = qp.get('enter') === '1';

    if (autoEnter) {
      // mark authed (so guards won’t bounce to auth.html elsewhere)
      sessionStorage.setItem('cs_authed','1');
      localStorage.setItem('cs_authed','1');
      document.cookie = "cs_auth=1; path=/; max-age=7200; SameSite=Lax";

      // switch immediately to console view (no tiles opened)
      document.body.classList.add('console-mode');
    }

    /* ---------- 2) Backdrop image (static list; first is used) ---------- */
    const BG = '/beta/assets/bg/IMG_5374.jpeg';
    const bgEl = document.getElementById('backdropImage');
    if (bgEl) {
      const img = new Image();
      img.onload = () => { bgEl.style.backgroundImage = `url("${BG}")`; bgEl.style.opacity = '1'; };
      img.src = BG;
    }

    /* ---------- 3) Tile system (tabs open tiles; none open by default) ---------- */
    const tilesWrap = document.getElementById('cs-tiles');
    const tabs = document.querySelectorAll('.cs-tab');
    const openKeys = new Set();

    const TEMPLATES = {
      overview: () => `
        <header class="cs-tile-head">
          <h4>Overview</h4><button class="cs-close" aria-label="Close">×</button>
        </header>
        <div class="cs-tile-body"><p>Overview content goes here.</p></div>`,
      itinerary: () => `
        <header class="cs-tile-head">
          <h4>Itinerary</h4><button class="cs-close" aria-label="Close">×</button>
        </header>
        <div class="cs-tile-body"><p>Trip segments, dates, carriers.</p></div>`,
      values: () => `
        <header class="cs-tile-head">
          <h4>Value Calc</h4><button class="cs-close" aria-label="Close">×</button>
        </header>
        <div class="cs-tile-body"><p>CPP, cash vs award, transfer hints.</p></div>`
    };

    function updateWrapClass(){
      const n = tilesWrap.querySelectorAll('.cs-tile').length;
      tilesWrap.classList.toggle('single', n === 1);
    }

    function addTileHandlers(tile){
      tile.querySelector('.cs-close')?.addEventListener('click', () => {
        const k = tile.dataset.key;
        tile.remove();
        openKeys.delete(k);
        updateWrapClass();
      });
    }

    function openTile(key){
      const exist = tilesWrap.querySelector(`.cs-tile[data-key="${key}"]`);
      if (exist) { exist.focus?.(); return; }
      const sec = document.createElement('section');
      sec.className = 'cs-tile';
      sec.dataset.key = key;
      sec.innerHTML = (TEMPLATES[key] || (()=>`
        <header class="cs-tile-head"><h4>${key}</h4><button class="cs-close" aria-label="Close">×</button></header>
        <div class="cs-tile-body"><p>${key} tile.</p></div>`))();
      openKeys.add(key);
      tilesWrap.appendChild(sec);
      addTileHandlers(sec);
      updateWrapClass();
    }

    tabs.forEach(btn => {
      btn.addEventListener('click', () => openTile(btn.dataset.key));
    });

    /* ---------- 4) If not autoEntering, stay on landing; otherwise we’re done ---------- */
    // Nothing else to open automatically; we intentionally start with an empty grid.
  })();
  </script>
  <script>
/* Silent fullscreen on first interaction when arriving with ?enter=1 */
(function () {
  if (new URLSearchParams(location.search).get('enter') !== '1') return;

  function tryFS() {
    const el = document.documentElement;
    const req = el.requestFullscreen || el.webkitRequestFullscreen ||
                el.mozRequestFullScreen || el.msRequestFullscreen;
    try { if (req) req.call(el); } catch (_) {}
    window.removeEventListener('pointerdown', tryFS, true);
    window.removeEventListener('keydown',     tryFS, true);
  }

  // First interaction anywhere in the page triggers fullscreen
  window.addEventListener('pointerdown', tryFS, true);
  window.addEventListener('keydown',     tryFS, true);
})();
</script>

</body>
</html>

