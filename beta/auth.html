<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Sign in — ConciergeSync™</title>
<style>
  :root{
    --glass: rgba(255,255,255,.10);
    --glass-border: rgba(255,255,255,.25);
    --card-shadow: 0 12px 40px rgba(0,0,0,.32);
    --text: #ecf0f6;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;
    font-family: system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif;
    color:var(--text);
    background:#0a0e13;
  }
  /* Backdrop */
  .backdrop{position:fixed; inset:0; z-index:0; overflow:hidden;}
  .backdrop::before{
    content:"";
    position:absolute; inset:0;
    background:url("/beta/assets/bg/IMG_5374.jpeg") center/cover no-repeat;
    filter:brightness(1.12) contrast(1.06);
    transform:scale(1.02);
  }
  .backdrop::after{
    content:"";
    position:absolute; inset:0;
    background:linear-gradient(to bottom, rgba(0,0,0,.25), rgba(0,0,0,.50));
  }

  /* Card */
  .auth-wrap{
    position:relative; z-index:1;
    display:grid; place-items:center;
    min-height:100dvh; padding:24px;
  }
  .auth-card{
    width:clamp(560px, 58vw, 720px);
    border:1px solid var(--glass-border);
    border-radius:16px;
    background:var(--glass);
    backdrop-filter: blur(10px) saturate(1.15);
    box-shadow: var(--card-shadow);
    padding:28px 26px 22px;
  }
  h1{
    margin:0 0 12px;
    font-size:clamp(28px, 3.2vw, 42px);
    line-height:1.15;
    letter-spacing:.2px;
  }
  .sub{ margin:0 0 16px; color:#d8dee9; }

  .row{ display:flex; gap:12px; align-items:center; }
  input[type="email"]{
    flex: 1 1 auto;
    height:44px; padding:0 14px;
    border-radius:10px; border:1px solid rgba(255,255,255,.35);
    background:rgba(8,10,13,.55); color:#fff; outline:none;
  }
  input[type="email"]::placeholder{ color:#b9c1cc; }

  .btn{
    height:44px; display:inline-flex; align-items:center; justify-content:center;
    padding:0 16px; border-radius:12px; cursor:pointer;
    border:1px solid rgba(255,255,255,.55);
    background:transparent; color:#fff; font-weight:800;
  }
  .btn.primary{ background:#fff; color:#111; border-color:#fff; }

  .warn{
    margin:10px 0 2px;
    padding:10px 12px;
    border-radius:10px;
    border:1px solid rgba(240,80,80,.55);
    background:rgba(140,20,20,.35);
    color:#ffe7e7; display:none;
  }
  .links{
    display:flex; gap:14px; margin-top:12px;
  }
  .links .btn{ flex:1 1 0; }

  .small-note{ margin-top:8px; color:#cbd5e1; font-size:.92rem; opacity:.9;}
</style>
</head>
<body>
  <div class="backdrop" aria-hidden="true"></div>

  <main class="auth-wrap">
    <section class="auth-card" role="dialog" aria-modal="true">
      <h1>Sign in to ConciergeSync™</h1>
      <p class="sub">Enter your email (and password if enabled) to continue to your console.</p>

      <form id="authForm" class="form" autocomplete="on" novalidate>
        <div class="row">
          <input id="email" name="email" type="email" inputmode="email"
                 placeholder="you@example.com" required />
          <button id="submitBtn" class="btn primary" type="submit">Enter Console</button>
        </div>

        <p id="warn" class="warn" role="alert">
          That email wasn’t recognized. If you’re new, tap “I’m new — Join the beta.”
        </p>

        <div class="links">
          <a class="btn" href="/beta/what-is.html">What is ConciergeSync?</a>
          <a class="btn" href="/beta/02-agree.html">I’m new — Join the beta</a>
        </div>

        <div class="small-note">No bank logins required.</div>
      </form>
    </section>
  </main>

<script>
(() => {
  const form = document.getElementById('authForm');
  const emailEl = document.getElementById('email');
  const warn = document.getElementById('warn');

  // Treat internal testers + previously-joined beta as recognized.
  const INTERNAL_DOMAIN = 'conciergesync.ai';
  const ALLOWLIST = [
    // Add specific addresses here if you need to hard-allow them.
    // "example@conciergesync.ai",
  ];

  function isRecognizedEmail(email){
    if (!email || !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) return false;
    const lc = email.trim().toLowerCase();
    if (ALLOWLIST.includes(lc)) return true;
    if (lc.endsWith('@' + INTERNAL_DOMAIN)) return true;
    // Flag that gets set when a user completes the join flow once.
    if (localStorage.getItem('cs_beta_ok') === '1') return true;
    return false;
  }

  function goConsole(email){
    try {
      sessionStorage.setItem('cs_email', email);
      localStorage.setItem('cs_email', email);
      // mark auth cookie for the console “guards”
      document.cookie = "cs_auth=1; path=/; max-age=7200; SameSite=Lax";
    } catch(_) {}
    // jump straight into console (shows the FS prompt there)
    window.location.assign('/beta/01-index.html?enter=1&open=overview');
  }

  form.addEventListener('submit', (e) => {
    e.preventDefault();
    warn.style.display = 'none';

    const email = emailEl.value.trim();
    if (isRecognizedEmail(email)) {
      goConsole(email);
    } else {
      warn.style.display = 'block';
      emailEl.focus();
    }
  });

  // UX niceties
  emailEl.focus();
})();
</script>
</body>
</html>
