<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Welcome To ConciergeSyncâ„¢</title>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
<style>
  :root{ --glass:rgba(255,255,255,.10); --brd:rgba(255,255,255,.28); --blur:blur(12px) saturate(1.2) }
  html,body{height:100%}
  body{
    margin:0; font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif; color:#fff;
    background:#0b1220;
  }
  .bg{position:fixed; inset:0; background:center/cover no-repeat; filter:brightness(1.08) contrast(1.04)}
  .ov{position:fixed; inset:0; background:linear-gradient(180deg, rgba(0,0,0,.35), rgba(0,0,0,.60))}
  .wrap{position:relative; min-height:100%; display:grid; place-items:center; padding:20px}
  .card{
    width:min(900px,94vw);
    border:1px solid var(--brd); background:var(--glass); backdrop-filter:var(--blur);
    border-radius:20px; padding:26px 26px 22px; box-shadow:0 14px 44px rgba(0,0,0,.35)
  }
  h1{margin:0 0 6px; font-weight:800; font-size:clamp(28px,4.6vw,48px); letter-spacing:-.01em; text-align:center}
  p.lead{text-align:center; margin:6px 0 18px; color:#e7ecf6}
  .tabs{display:flex; gap:10px; justify-content:center; margin:6px 0 18px}
  .tab{
    padding:10px 14px; border-radius:999px; border:1px solid rgba(255,255,255,.25);
    background:rgba(0,0,0,.25); cursor:pointer; font-weight:700; color:#fff
  }
  .tab.is-active{background:#000;border-color:#000}
  .grid{display:grid;grid-template-columns:1fr 1fr;gap:12px}
  .grid .full{grid-column:1/-1}
  label{font-size:13px;color:#dbe2ee}
  input[type="text"],input[type="email"]{
    width:100%;padding:12px 14px;border-radius:12px;border:1px solid rgba(255,255,255,.24);
    background:rgba(0,0,0,.35);color:#fff;outline:none
  }
  .row{display:flex;align-items:center;gap:10px;margin-top:8px}
  .err{color:#ffd0d0;font-size:13px;display:none}
  .actions{display:flex;flex-wrap:wrap;gap:10px;align-items:center;margin-top:16px}
  button,.btn{
    display:inline-flex;align-items:center;justify-content:center;gap:10px;padding:12px 16px;border-radius:999px;
    color:#111;font-weight:800;border:1px solid #fff;background:#fff;cursor:pointer;text-decoration:none
  }
  .ghost{background:transparent;color:#fff;border-color:rgba(255,255,255,.24)}
  .ghost:hover{border-color:rgba(255,255,255,.34);background:rgba(255,255,255,.08)}
  .right{margin-left:auto}
  .muted{color:#cdd3dd}
  @media (max-width:720px){ .grid{grid-template-columns:1fr} #nameRow{grid-template-columns:1fr!important} }
</style>
</head>
<body>
  <div id="bg" class="bg"></div>
  <div class="ov"></div>

  <div class="wrap">
    <div class="card" role="form" aria-labelledby="welcomeTitle">
      <h1 id="welcomeTitle">Welcome To ConciergeSyncâ„¢ ðŸ‘‹</h1>
      <p class="lead">Sign in or create your account with your email.</p>

      <div class="tabs" role="tablist" aria-label="Choose mode">
        <button id="tabLogin" class="tab" role="tab" aria-selected="false">Returning user? Log in</button>
        <button id="tabReg"   class="tab is-active" role="tab" aria-selected="true">New user? Register</button>
      </div>

      <div class="grid" id="fields">
        <div class="full" id="nameRow" style="display:grid;grid-template-columns:1fr 1fr;gap:12px">
          <div>
            <label for="first">First name</label>
            <input id="first" type="text" autocomplete="given-name" placeholder="First name"/>
          </div>
          <div>
            <label for="last">Last name</label>
            <input id="last" type="text" autocomplete="family-name" placeholder="Last name"/>
          </div>
        </div>

        <div class="full">
          <label for="email">Email (your LoginID)</label>
          <input id="email" type="email" autocomplete="email" inputmode="email" placeholder="you@example.com"/>
          <div id="errEmail" class="err">Please enter a valid email address.</div>
        </div>

        <div class="full" id="agreeRow">
          <label class="row">
            <input id="agree" type="checkbox" style="width:16px;height:16px">
            <span>I agree to the <a class="btn-link" href="/beta/terms.html" target="_self" style="color:#fff;text-decoration:underline">Terms &amp; Privacy</a>.</span>
          </label>
          <div id="errAgree" class="err">You must agree to continue.</div>
        </div>
      </div>

      <div class="actions">
        <button id="submit">Create account</button>
        <a class="btn ghost" href="/index.html">What is ConciergeSync?</a>
      </div>

      <div class="muted" style="margin-top:12px;font-size:12px">
        Protected by rate-limiting and verification. Weâ€™ll never share your email.
      </div>
    </div>
  </div>

<script>
  // Background: keep whatever was set earlier; fallback to the wing image.
  (function(){
    var src = localStorage.getItem('cs_bg_src') || '/beta/assets/bg/IMG_5374.jpeg';
    document.getElementById('bg').style.backgroundImage = 'url(' + src + ')';
  })();

  // Canonical gate logic (tabs + validation + redirect to console)
  (function(){
    const $ = s => document.querySelector(s);
    const mode = { value: 'register' }; // or 'login'

    const tabLogin = $('#tabLogin'), tabReg = $('#tabReg');
    const nameRow = $('#nameRow'), agreeRow = $('#agreeRow');
    const first = $('#first'), last = $('#last'), email = $('#email'), agree = $('#agree');
    const errEmail = $('#errEmail'), errAgree = $('#errAgree'), submit = $('#submit');

    function validEmail(v){ return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(v); }

    function setMode(m){
      mode.value = m;
      const login = m === 'login';
      tabLogin.classList.toggle('is-active', login);
      tabReg.classList.toggle('is-active', !login);
      tabLogin.setAttribute('aria-selected', login);
      tabReg.setAttribute('aria-selected', !login);
      nameRow.style.display = login ? 'none' : 'grid';
      agreeRow.style.display = login ? 'none' : 'block';
      submit.textContent    = login ? 'Log in' : 'Create account';
    }
    tabLogin.addEventListener('click', ()=> setMode('login'));
    tabReg.addEventListener('click',   ()=> setMode('register'));

    // Prefill convenience
    try{
      const p = JSON.parse(localStorage.getItem('cs_profile')||'{}');
      if(p.first) first.value = p.first;
      if(p.last)  last.value  = p.last;
      const em = localStorage.getItem('cs_prefill_email') || p.email || '';
      if(em) email.value = em;
    }catch{}

    function clearErrors(){ errEmail.style.display='none'; errAgree.style.display='none'; }
    ['input','change'].forEach(evt=>{
      [first,last,email,agree].forEach(el => el.addEventListener(evt, clearErrors));
    });

    function goConsole(){
      try{
        localStorage.setItem('cs_authed','1');
        sessionStorage.setItem('cs_authed','1');
      }catch{}
      // Send with ?enter=1 so the console shows the fullscreen pill
      location.replace('/beta/01-index.html?enter=1');
    }

    submit.addEventListener('click', () => {
      clearErrors();
      const e = email.value.trim();
      if(!validEmail(e)){ errEmail.style.display='block'; errEmail.textContent='Please enter a valid email address.'; return; }

      if(mode.value === 'login'){
        try{ localStorage.setItem('cs_prefill_email', e); }catch{}
        return goConsole();
      }

      // register
      const f = first.value.trim(), l = last.value.trim();
      if(!f || !l){ errEmail.style.display='block'; errEmail.textContent='Please complete all fields.'; return; }
      if(!agree.checked){ errAgree.style.display='block'; return; }

      try{
        localStorage.setItem('cs_profile', JSON.stringify({first:f,last:l,email:e,agreed:true}));
        localStorage.setItem('cs_prefill_email', e);
      }catch{}
      goConsole();
    });

    // Submit on Enter in email
    email.addEventListener('keydown', e => { if(e.key==='Enter') submit.click(); });
  })();
</script>
</body>
</html>
